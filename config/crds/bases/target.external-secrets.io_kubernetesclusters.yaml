apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.19.0
  labels:
    external-secrets.io/component: controller
  name: kubernetesclusters.target.external-secrets.io
spec:
  group: target.external-secrets.io
  names:
    categories:
    - external-secrets
    - external-secrets-target
    kind: KubernetesCluster
    listKind: KubernetesClusterList
    plural: kubernetesclusters
    singular: kubernetescluster
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - jsonPath: .status.conditions[?(@.type=="Ready")].reason
      name: Status
      type: string
    - jsonPath: .status.capabilities
      name: Capabilities
      type: string
    - jsonPath: .status.conditions[?(@.type=="Ready")].status
      name: Ready
      type: string
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: KubernetesCluster is the schema for a Kubernetes target.
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: KubernetesClusterSpec contains the KubernetesCluster spec.
            properties:
              auth:
                description: Auth configures how secret-manager authenticates with
                  a Kubernetes instance.
                maxProperties: 1
                minProperties: 1
                properties:
                  cert:
                    description: has both clientCert and clientKey as secretKeySelector
                    properties:
                      clientCert:
                        description: |-
                          SecretKeySelector is a reference to a specific 'key' within a Secret resource.
                          In some instances, `key` is a required field.
                        properties:
                          key:
                            description: |-
                              A key in the referenced Secret.
                              Some instances of this field may be defaulted, in others it may be required.
                            maxLength: 253
                            minLength: 1
                            pattern: ^[-._a-zA-Z0-9]+$
                            type: string
                          name:
                            description: The name of the Secret resource being referred
                              to.
                            maxLength: 253
                            minLength: 1
                            pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$
                            type: string
                          namespace:
                            description: |-
                              The namespace of the Secret resource being referred to.
                              Ignored if referent is not cluster-scoped, otherwise defaults to the namespace of the referent.
                            maxLength: 63
                            minLength: 1
                            pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?$
                            type: string
                        type: object
                      clientKey:
                        description: |-
                          SecretKeySelector is a reference to a specific 'key' within a Secret resource.
                          In some instances, `key` is a required field.
                        properties:
                          key:
                            description: |-
                              A key in the referenced Secret.
                              Some instances of this field may be defaulted, in others it may be required.
                            maxLength: 253
                            minLength: 1
                            pattern: ^[-._a-zA-Z0-9]+$
                            type: string
                          name:
                            description: The name of the Secret resource being referred
                              to.
                            maxLength: 253
                            minLength: 1
                            pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$
                            type: string
                          namespace:
                            description: |-
                              The namespace of the Secret resource being referred to.
                              Ignored if referent is not cluster-scoped, otherwise defaults to the namespace of the referent.
                            maxLength: 63
                            minLength: 1
                            pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?$
                            type: string
                        type: object
                    type: object
                  serviceAccount:
                    description: points to a service account that should be used for
                      authentication
                    properties:
                      audiences:
                        description: |-
                          Audience specifies the `aud` claim for the service account token
                          If the service account uses a well-known annotation for e.g. IRSA or GCP Workload Identity
                          then this audiences will be appended to the list
                        items:
                          type: string
                        type: array
                      name:
                        description: The name of the ServiceAccount resource being
                          referred to.
                        maxLength: 253
                        minLength: 1
                        pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$
                        type: string
                      namespace:
                        description: |-
                          Namespace of the resource being referred to.
                          Ignored if referent is not cluster-scoped, otherwise defaults to the namespace of the referent.
                        maxLength: 63
                        minLength: 1
                        pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?$
                        type: string
                    required:
                    - name
                    type: object
                  token:
                    description: use static token to authenticate with
                    properties:
                      bearerToken:
                        description: |-
                          SecretKeySelector is a reference to a specific 'key' within a Secret resource.
                          In some instances, `key` is a required field.
                        properties:
                          key:
                            description: |-
                              A key in the referenced Secret.
                              Some instances of this field may be defaulted, in others it may be required.
                            maxLength: 253
                            minLength: 1
                            pattern: ^[-._a-zA-Z0-9]+$
                            type: string
                          name:
                            description: The name of the Secret resource being referred
                              to.
                            maxLength: 253
                            minLength: 1
                            pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$
                            type: string
                          namespace:
                            description: |-
                              The namespace of the Secret resource being referred to.
                              Ignored if referent is not cluster-scoped, otherwise defaults to the namespace of the referent.
                            maxLength: 63
                            minLength: 1
                            pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?$
                            type: string
                        type: object
                    type: object
                type: object
              authRef:
                description: A reference to a secret that contains the auth information.
                properties:
                  key:
                    description: |-
                      A key in the referenced Secret.
                      Some instances of this field may be defaulted, in others it may be required.
                    maxLength: 253
                    minLength: 1
                    pattern: ^[-._a-zA-Z0-9]+$
                    type: string
                  name:
                    description: The name of the Secret resource being referred to.
                    maxLength: 253
                    minLength: 1
                    pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$
                    type: string
                  namespace:
                    description: |-
                      The namespace of the Secret resource being referred to.
                      Ignored if referent is not cluster-scoped, otherwise defaults to the namespace of the referent.
                    maxLength: 63
                    minLength: 1
                    pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?$
                    type: string
                type: object
              namespaces:
                description: |-
                  namespaces controls which namespaces are in scope during scans.
                  If both include and exclude are empty, all namespaces are included.
                  Include/exclude support glob-like patterns (implementation detail in provider).
                properties:
                  exclude:
                    items:
                      type: string
                    type: array
                  include:
                    items:
                      type: string
                    type: array
                type: object
              scan:
                description: scan toggles specific binding paths to consider as "manifest
                  bindings".
                properties:
                  includeEnvFrom:
                    default: true
                    description: 'IncludeEnvFrom: consider containers[*].envFrom[].secretRef
                      and initContainers[] equivalents.'
                    type: boolean
                  includeEnvSecretKeyRefs:
                    default: true
                    description: 'IncludeEnvSecretKeyRefs: consider containers[*].env[].valueFrom.secretKeyRef
                      (and initContainers).'
                    type: boolean
                  includeImagePullSecrets:
                    default: false
                    description: 'IncludeImagePullSecrets: consider spec.imagePullSecrets
                      and SA.imagePullSecrets.'
                    type: boolean
                  includeVolumeSecrets:
                    default: true
                    description: 'IncludeVolumeSecrets: consider volumes[].secret.secretName.'
                    type: boolean
                type: object
              selector:
                description: |-
                  selector filters workloads/pods by labels before scan evaluation.
                  If empty, all labeled/unlabeled workloads are considered.
                properties:
                  matchExpressions:
                    description: matchExpressions is a list of label selector requirements.
                      The requirements are ANDed.
                    items:
                      description: |-
                        A label selector requirement is a selector that contains values, a key, and an operator that
                        relates the key and values.
                      properties:
                        key:
                          description: key is the label key that the selector applies
                            to.
                          type: string
                        operator:
                          description: |-
                            operator represents a key's relationship to a set of values.
                            Valid operators are In, NotIn, Exists and DoesNotExist.
                          type: string
                        values:
                          description: |-
                            values is an array of string values. If the operator is In or NotIn,
                            the values array must be non-empty. If the operator is Exists or DoesNotExist,
                            the values array must be empty. This array is replaced during a strategic
                            merge patch.
                          items:
                            type: string
                          type: array
                          x-kubernetes-list-type: atomic
                      required:
                      - key
                      - operator
                      type: object
                    type: array
                    x-kubernetes-list-type: atomic
                  matchLabels:
                    additionalProperties:
                      type: string
                    description: |-
                      matchLabels is a map of {key,value} pairs. A single {key,value} in the matchLabels
                      map is equivalent to an element of matchExpressions, whose key field is "key", the
                      operator is "In", and the values array contains only "value". The requirements are ANDed.
                    type: object
                type: object
                x-kubernetes-map-type: atomic
              server:
                description: configures the Kubernetes server Address.
                properties:
                  caBundle:
                    description: CABundle is a base64-encoded CA certificate
                    format: byte
                    type: string
                  caProvider:
                    description: 'see: https://external-secrets.io/v0.4.1/spec/#external-secrets.io/v1alpha1.CAProvider'
                    properties:
                      key:
                        description: The key where the CA certificate can be found
                          in the Secret or ConfigMap.
                        maxLength: 253
                        minLength: 1
                        pattern: ^[-._a-zA-Z0-9]+$
                        type: string
                      name:
                        description: The name of the object located at the provider
                          type.
                        maxLength: 253
                        minLength: 1
                        pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$
                        type: string
                      namespace:
                        description: |-
                          The namespace the Provider type is in.
                          Can only be defined when used in a ClusterSecretStore.
                        maxLength: 63
                        minLength: 1
                        pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?$
                        type: string
                      type:
                        description: The type of provider to use such as "Secret",
                          or "ConfigMap".
                        enum:
                        - Secret
                        - ConfigMap
                        type: string
                    type: object
                  url:
                    default: kubernetes.default
                    description: configures the Kubernetes server Address.
                    type: string
                type: object
            type: object
          status:
            description: TargetStatus defines the observed state of the Target.
            properties:
              capabilities:
                description: TargetCapabilities defines the possible operations a
                  Target can do.
                type: string
              conditions:
                items:
                  description: TargetStatusCondition defines the status of a Target.
                  properties:
                    lastTransitionTime:
                      format: date-time
                      type: string
                    message:
                      type: string
                    reason:
                      type: string
                    status:
                      type: string
                    type:
                      description: TargetConditionType defines the possible conditions
                        a Target can have.
                      type: string
                  required:
                  - status
                  - type
                  type: object
                type: array
              pushIndex:
                additionalProperties:
                  items:
                    description: SecretUpdateRecord defines the timestamp when a PushSecret
                      was applied to a secret.
                    properties:
                      secretHash:
                        type: string
                      timestamp:
                        format: date-time
                        type: string
                    required:
                    - secretHash
                    - timestamp
                    type: object
                  type: array
                type: object
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
