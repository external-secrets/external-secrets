apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.19.0
  labels:
    external-secrets.io/component: controller
  name: consumers.scan.external-secrets.io
spec:
  group: scan.external-secrets.io
  names:
    categories:
    - external-secrets
    - external-secrets-scan
    kind: Consumer
    listKind: ConsumerList
    plural: consumers
    singular: consumer
  scope: Namespaced
  versions:
  - name: v1alpha1
    schema:
      openAPIV3Schema:
        description: Consumer is the schema to store duplicate findings from a job
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: ConsumerSpec defines the desired state of Consumer.
            properties:
              attributes:
                description: Exactly one of the following should be set according
                  to Type.
                properties:
                  gitHubActor:
                    description: GitHubActor defines the attributes of a GitHub actor.
                    properties:
                      actorID:
                        description: ActorID is the stable numeric id of the actor
                          if known.
                        type: string
                      actorLogin:
                        description: ActorLogin is the login of the actor.
                        type: string
                      actorType:
                        description: 'ActorType: "User" | "App" | "Bot" (GitHub notions)'
                        enum:
                        - User
                        - App
                        - Bot
                        type: string
                      event:
                        description: Optional context that led to detection (push/clone/workflow).
                        type: string
                      repository:
                        description: Repo slug "owner/name" for context (e.g., "acme/api").
                        type: string
                      workflowRunID:
                        description: 'Optional: workflow/job id when usage came from
                          Actions'
                        type: string
                    required:
                    - actorType
                    - repository
                    type: object
                  k8sWorkload:
                    description: K8sWorkload defines the attributes of a Kubernetes
                      workload.
                    properties:
                      clusterName:
                        description: ClusterName is the name of the cluster.
                        type: string
                      controller:
                        description: 'Convenience string for UIs: "deployment.apps/api"'
                        type: string
                      namespace:
                        description: Namespace is the namespace of the workload.
                        type: string
                      workloadGroup:
                        description: WorkloadGroup is the group of the workload.
                        type: string
                      workloadKind:
                        description: |-
                          Workload identity (top controller or naked Pod as fallback)
                          e.g., Kind="Deployment", Group="apps", Version="v1", Name="api"
                        type: string
                      workloadName:
                        description: WorkloadName is the name of the workload.
                        type: string
                      workloadUID:
                        description: WorkloadUID is the UID of the workload.
                        type: string
                      workloadVersion:
                        description: WorkloadVersion is the version of the workload.
                        type: string
                    required:
                    - namespace
                    - workloadKind
                    - workloadName
                    type: object
                  vmProcess:
                    description: VMProcess defines the attributes of a VM process.
                    properties:
                      cmdline:
                        description: Cmdline is the command line arguments.
                        type: string
                      euid:
                        description: EUID is the effective user ID.
                        format: int64
                        type: integer
                      executable:
                        description: Executable is the path to the executable.
                        type: string
                      ruid:
                        description: RUID is the real user ID.
                        format: int64
                        type: integer
                    required:
                    - euid
                    - ruid
                    type: object
                type: object
              displayName:
                description: Human readable name for UIs.
                type: string
              id:
                description: A stable ID for correlation across scans.
                minLength: 1
                type: string
              target:
                description: TargetReference defines a reference to a target.
                properties:
                  name:
                    description: Name is the name of the target.
                    type: string
                  namespace:
                    description: Namespace is the namespace of the target.
                    type: string
                required:
                - name
                - namespace
                type: object
              type:
                description: Type discriminates which payload below is populated.
                type: string
            required:
            - attributes
            - displayName
            - id
            - target
            - type
            type: object
          status:
            description: ConsumerStatus defines the observed state of Consumer.
            properties:
              conditions:
                description: Conditions is a list of metav1.Condition.
                items:
                  description: Condition contains details for one aspect of the current
                    state of this API Resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: |-
                        observedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: |-
                        reason contains a programmatic identifier indicating the reason for the condition's last transition.
                        Producers of specific condition types may define expected values and meanings for this field,
                        and whether the values are considered a guaranteed API.
                        The value should be a CamelCase string.
                        This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
              locations:
                description: Locations is a list of SecretInStoreRef.
                items:
                  description: SecretInStoreRef defines a reference to a secret in
                    a secret store.
                  properties:
                    apiVersion:
                      type: string
                    kind:
                      type: string
                    name:
                      type: string
                    remoteRef:
                      description: RemoteRef defines a reference to a remote secret.
                      properties:
                        endIndex:
                          type: integer
                        key:
                          type: string
                        property:
                          type: string
                        startIndex:
                          type: integer
                      required:
                      - key
                      type: object
                  required:
                  - apiVersion
                  - kind
                  - name
                  - remoteRef
                  type: object
                type: array
              observedIndex:
                additionalProperties:
                  description: SecretUpdateRecord defines the timestamp when a PushSecret
                    was applied to a secret.
                  properties:
                    secretHash:
                      type: string
                    timestamp:
                      format: date-time
                      type: string
                  required:
                  - secretHash
                  - timestamp
                  type: object
                description: ObservedIndex is a map of secret names to SecretUpdateRecord.
                type: object
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
